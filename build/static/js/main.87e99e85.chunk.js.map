{"version":3,"sources":["routers/history.js","components/MovieItem.js","services/index.js","components/Header.js","containers/Movies.js","containers/Subject.js","routers/index.js","App.js","index.js"],"names":["createBrowserHistory","MovieItem","props","data","onClick","onTitleClick","react_default","a","createElement","className","event","preventDefault","src","images","small","alt","title","stopPropagation","defaultProps","axios","defaults","baseURL","getInTheaters","Promise","_ref","Object","asyncToGenerator","regenerator_default","mark","_callee","resolve","reject","_ref2","subjects","wrap","_context","prev","next","get","sent","stop","_x","_x2","apply","this","arguments","getMovieDetail","id","_ref3","_callee2","_ref4","_context2","concat","_x3","Header","history","goBack","name","withRouter","_useState","useState","_useState2","slicedToArray","theaters","setTheaters","useEffect","then","result","catch","error","console","handleClick","item","version","path","push","pathname","Fragment","components_Header","map","Math","ceil","random","key","genres","aka","detail","setDetail","getDetail","match","params","medium","year","index","summary","wish_count","Routes","Router","Switch","Route","component","Movies","Subject","render","Redirect","to","App","routers","ReactDOM","src_App","document","getElementById","navigator","serviceWorker","register","registration","log","publicKey","subscribeOptions","userVisibleOnly","applicationServerKey","window","urlBase64ToUint8Array","pushManager","subscribe","pushSubscription","subscribeUserToPush","subscription","base64String","base64","repeat","length","replace","rawData","atob","outputArray","Uint8Array","i","charCodeAt"],"mappings":"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","file":"static/js/main.87e99e85.chunk.js","sourcesContent":["import { createBrowserHistory } from \"history\";\n\nexport default createBrowserHistory();\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nexport default function MovieItem(props) {\n  const { data, onClick, onTitleClick } = props;\n\n  const handleClick = event => {\n    event.preventDefault();\n    onClick();\n  };\n\n  const handleTitleClick = event => {\n    event.stopPropagation();\n    onTitleClick();\n  };\n\n  return (\n    <div className=\"movie-item\">\n      <div onClick={handleClick}>\n        <img\n          className=\"movie-item-cover\"\n          src={data.images.small}\n          alt={data.title}\n        />\n      </div>\n      <p onClick={handleTitleClick} className=\"movie-item-title\">\n        {data.title}\n      </p>\n    </div>\n  );\n}\n\nMovieItem.propTypes = {\n  onClick: PropTypes.func\n};\n\nMovieItem.defaultProps = {\n  onClick: () => {},\n  onTitleClick: () => {}\n};\n","import axios from \"axios\";\n\naxios.defaults.baseURL = \"https://easy-mock.com/mock/5b20fc50c0f62604c7cefdb9\";\n\n// https://bangumi.bilibili.com/api/timeline_v2_global\nconst getInTheaters = () => {\n  return new Promise(async function(resolve, reject) {\n    const {\n      data: { subjects }\n    } = await axios.get(\"/proxyMovies\");\n    resolve(subjects);\n  });\n};\n\nconst getMovieDetail = id => {\n  return new Promise(async function(resolve) {\n    const { data } = await axios.get(`/proxyDetail/${id}`);\n    resolve(data);\n  });\n};\n\nexport { getInTheaters, getMovieDetail };\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport history from '../routers/history'\n\nimport \"../styles/header.scss\";\n\nfunction Header(props) {\n  const handleBack = () => {\n    history.goBack()\n  }\n  \n  return (\n    <header className=\"header\">\n        <span className=\"header-left\" onClick={handleBack}>\n          &lt;\n        </span>\n        <div>{props.name}</div>\n      </header>\n  )\n}\n\nHeader.propTypes = {\n  name: PropTypes.string\n}\n\nexport default Header\n","import React, { useState, useEffect } from \"react\";\nimport MovieItem from \"../components/MovieItem\";\nimport { getInTheaters } from \"../services\";\nimport { withRouter } from \"react-router-dom\";\nimport Header from \"../components/Header\";\nimport \"../styles/movie.scss\";\n\nfunction Movies(props) {\n  const [theaters, setTheaters] = useState([]);\n\n  const getTheaters = () => {\n    getInTheaters()\n      .then(result => {\n        setTheaters(result);\n      })\n      .catch(error => console.error(error));\n  };\n\n  useEffect(() => {\n    getTheaters();\n  }, []);\n\n  const handleClick = (item, version) => {\n    const { history } = props;\n    let path = `/subject/${item.id}`;\n    if (version >= 0) {\n      path = `/subject/${item.id}?v=${version}`;\n    }\n    history.push({\n      pathname: path\n    });\n  };\n\n  return (\n    <React.Fragment>\n      <Header name=\"List\" />\n      <div className=\"movie\">\n        {theaters.map(item => (\n          <MovieItem\n            onClick={() => handleClick(item)}\n            onTitleClick={() => handleClick(item, Math.ceil(Math.random() * 10))}\n            data={item}\n            key={item.id}\n          />\n        ))}\n      </div>\n    </React.Fragment>\n  );\n}\n\nexport default withRouter(Movies);\n","import React, { useState, useEffect } from \"react\";\nimport { getMovieDetail } from \"../services\";\nimport { withRouter } from \"react-router-dom\";\nimport Header from \"../components/Header\";\n\nfunction Subject(props) {\n  const [detail, setDetail] = useState({ images: {}, genres: [], aka: [] });\n\n  // const getDataFromCaches = () => {\n  //   const {\n  //     match: {\n  //       params: { id }\n  //     }\n  //   } = props;\n  //   return new Promise((resolve, reject) => {\n  //     if (\"caches\" in window) {\n  //       caches.match(id).then(match => {\n  //         console.log(caches, match, id);\n  //         if (match) {\n  //           resolve(match.json());\n  //         } else {\n  //           resolve();\n  //         }\n  //       });\n  //     } else {\n  //       reject();\n  //     }\n  //   });\n  // };\n\n  const getDetail = async () => {\n    const { match } = props;\n    const result = await getMovieDetail(match.params.id);\n    if (result) {\n      setDetail(result);\n    }\n    // getDataFromCaches()\n    //   .then(result => {\n    //     console.log(result);\n    //     if (result) {\n    //       setDetail(result);\n    //     }\n    //   })\n    //   .then(async () => {\n    //     const result = await getMovieDetail(match.params.id);\n    //     if (result) {\n    //       setDetail(result);\n    //     }\n    //   });\n  };\n\n  useEffect(() => {\n    getDetail();\n  }, []);\n  if (detail) {\n    return (\n      <div>\n        <Header name={detail.title} />\n        {detail.images && <img src={detail.images.medium} alt={detail.title} />}\n        <p>\n          {detail.title} {detail.year}年\n        </p>\n        <p>\n          {detail.genres.map((item, index) => (\n            <span key={index}>{item}</span>\n          ))}\n        </p>\n        <p>\n          {detail.aka.map((item, index) => (\n            <span key={index}>{item}&nbsp;</span>\n          ))}\n        </p>\n        <p>{detail.summary}</p>\n        <p>{detail.wish_count}想看</p>\n      </div>\n    );\n  }\n  return null;\n}\n\nexport default withRouter(Subject);\n","import React from \"react\";\nimport { Switch, Route, Redirect, Router } from \"react-router-dom\";\n\nimport history from \"./history\";\n\nimport Movies from \"../containers/Movies\";\nimport Subject from \"../containers/Subject\";\n\nfunction Routes() {\n  return (\n    <React.Fragment>\n      <Router history={history}>\n        <Switch>\n          <Route path=\"/movies\" component={Movies} />\n          <Route path=\"/subject/:id\" component={Subject} />\n          <Route path=\"/\" render={() => <Redirect to=\"/movies\" />} />\n        </Switch>\n      </Router>\n    </React.Fragment>\n  );\n}\n\nexport default Routes;\n","import React from 'react';\nimport './App.css';\nimport Routes from './routers';\n\nfunction App() {\n  return <Routes />;\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n// import * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n\nconst PUBLICKEY =\n  \"BL8r5BALDYTeDIbzCS43r22IhdHZsaj1Ads1-9ouLDZSi9yveDlM8VyQdbez-0Qwuo8GhBPG89y1hyUY_5fVdhs\";\n// const PRIVATEKEY = \"LMLDzvDFDICNT6BRKeM8y61bPskU4-GmbZtxM-BE2Ms\";\n\nif (\"serviceWorker\" in navigator) {\n  navigator.serviceWorker\n    .register(\"./sw.js\")\n    .then(function(registration) {\n      console.log(\"Service Worker 注册成功\");\n      return subscribeUserToPush(registration, PUBLICKEY);\n    })\n    .then(subscription => {\n      console.log(\"订阅成功\");\n    });\n}\n\nfunction subscribeUserToPush(registration, publicKey) {\n  const subscribeOptions = {\n    userVisibleOnly: true,\n    applicationServerKey: window.urlBase64ToUint8Array(publicKey)\n  };\n  if (registration && registration.pushManager) {\n    return registration.pushManager\n      .subscribe(subscribeOptions)\n      .then(function(pushSubscription) {\n        console.log(\"Received PushSubscription\");\n        return pushSubscription;\n      });\n  }\n}\n\nwindow.urlBase64ToUint8Array = function(base64String) {\n  const padding = \"=\".repeat((4 - (base64String.length % 4)) % 4);\n  const base64 = (base64String + padding)\n    .replace(/\\-/g, \"+\") // eslint-disable-line\n    .replace(/_/g, \"/\");\n\n  const rawData = window.atob(base64);\n  const outputArray = new Uint8Array(rawData.length);\n\n  for (let i = 0; i < rawData.length; ++i) {\n    outputArray[i] = rawData.charCodeAt(i);\n  }\n  return outputArray;\n};\n"],"sourceRoot":""}