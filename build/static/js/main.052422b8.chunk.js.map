{"version":3,"sources":["components/MovieItem.js","services/index.js","containers/Movies.js","containers/Subject.js","routers/index.js","App.js","index.js"],"names":["MovieItem","props","data","onClick","react_default","a","createElement","className","src","images","medium","alt","title","defaultProps","axios","defaults","baseURL","getInTheaters","Promise","_ref","Object","asyncToGenerator","regenerator_default","mark","_callee","resolve","_ref2","subjects","wrap","_context","prev","next","get","sent","stop","_x","apply","this","arguments","getMovieDetail","id","_ref3","_callee2","_ref4","_context2","post","_x2","withRouter","_useState","useState","_useState2","slicedToArray","theaters","setTheaters","useEffect","then","result","catch","error","console","map","item","history","push","pathname","concat","handleClick","key","genres","aka","detail","setDetail","getDetail","match","reject","window","caches","json","log","params","index","Routes","HashRouter","Switch","Route","path","component","Movies","Subject","render","Redirect","to","App","routers","ReactDOM","src_App","document","getElementById","navigator","serviceWorker","register"],"mappings":"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","file":"static/js/main.052422b8.chunk.js","sourcesContent":["import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nexport default function MovieItem(props) {\n  const { data, onClick } = props;\n\n  const handleClick = () => {\n    onClick();\n  };\n\n  return (\n    <div onClick={handleClick} className=\"movie-item\">\n      <img\n        className=\"movie-item-cover\"\n        src={data.images.medium}\n        alt={data.title}\n      />\n      <p className=\"movie-item-title\">{data.title}</p>\n    </div>\n  );\n}\n\nMovieItem.propTypes = {\n  onClick: PropTypes.func\n};\n\nMovieItem.defaultProps = {\n  onClick: () => {}\n};\n","import axios from \"axios\";\n\naxios.defaults.baseURL = \"http://localhost:3030\";\n\n// https://bangumi.bilibili.com/api/timeline_v2_global\nconst getInTheaters = () => {\n  return new Promise(async function(resolve) {\n    const {\n      data: { subjects }\n    } = await axios.get(\"/movies\");\n    resolve(subjects);\n  });\n};\n\nconst getMovieDetail = id => {\n  return new Promise(async function(resolve) {\n    const { data } = await axios.post(`/detail`, { id });\n    resolve(data);\n  });\n};\n\nexport { getInTheaters, getMovieDetail };\n","import React, { useState, useEffect } from \"react\";\nimport MovieItem from \"../components/MovieItem\";\nimport { getInTheaters } from \"../services\";\nimport { withRouter } from \"react-router-dom\";\nimport \"../styles/movie.scss\";\n\nfunction Movies(props) {\n  const [theaters, setTheaters] = useState([]);\n\n  const getTheaters = () => {\n    getInTheaters()\n      .then(result => {\n        setTheaters(result);\n      })\n      .catch(error => console.error(error));\n  };\n\n  useEffect(() => {\n    getTheaters();\n  }, []);\n\n  const handleClick = item => {\n    const { history } = props;\n    history.push({\n      pathname: `/subject/${item.id}`\n    });\n  };\n\n  return (\n    <div className=\"movie\">\n      {theaters.map(item => (\n        <MovieItem\n          onClick={() => handleClick(item)}\n          data={item}\n          key={item.id}\n        />\n      ))}\n    </div>\n  );\n}\n\nexport default withRouter(Movies);\n","import React, { useState, useEffect } from \"react\";\nimport { getMovieDetail } from \"../services\";\nimport { withRouter } from \"react-router-dom\";\n\nfunction Subject(props) {\n  const [detail, setDetail] = useState({ images: [], genres: [], aka: [] });\n\n  const getDataFromCaches = () => {\n    return new Promise((resolve, reject) => {\n      if (\"caches\" in window) {\n        caches.match(\"http://localhost:3030/detail\").then(match => {\n          if (match) {\n            resolve(match.json());\n          } else {\n            resolve();\n          }\n        });\n      } else {\n        reject();\n      }\n    });\n  };\n\n  const getDetail = async () => {\n    const { match } = props;\n    getDataFromCaches()\n      .then(result => {\n        console.log(result);\n        if (result) {\n          setDetail(result);\n        }\n      })\n      .then(async () => {\n        const result = await getMovieDetail(match.params.id);\n        if (result) {\n          setDetail(result);\n        }\n      });\n  };\n\n  useEffect(() => {\n    getDetail();\n  }, []);\n\n  return (\n    <div>\n      <img src={detail.images.medium} alt={detail.title} />\n      <p>{detail.title}</p>\n      <p>\n        {detail.genres.map((item, index) => (\n          <span key={index}>{item}</span>\n        ))}\n      </p>\n      <p>\n        {detail.aka.map((item, index) => (\n          <span key={index}>{item}</span>\n        ))}\n      </p>\n    </div>\n  );\n}\n\nexport default withRouter(Subject);\n","import React from \"react\";\nimport { Switch, Route, Redirect, HashRouter } from \"react-router-dom\";\n\nimport Movies from \"../containers/Movies\";\nimport Subject from \"../containers/Subject\";\n\nfunction Routes() {\n  return (\n    <HashRouter>\n      <Switch>\n        <Route path=\"/movies\" component={Movies} />\n        <Route path=\"/subject/:id\" component={Subject} />\n        <Route path=\"/\" render={() => <Redirect to=\"/movies\" />} />\n      </Switch>\n    </HashRouter>\n  );\n}\n\nexport default Routes;\n","import React from 'react';\nimport './App.css';\nimport Routes from './routers';\n\nfunction App() {\n  return <Routes />;\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n// import * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\nif ('serviceWorker' in navigator) {\n  navigator.serviceWorker.register('./sw.js').then(function () {\n      console.log('Service Worker 注册成功');\n  });\n}\n"],"sourceRoot":""}